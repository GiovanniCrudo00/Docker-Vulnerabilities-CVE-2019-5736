# Docker-Vulnerabilities-CVE-2019-5736-
Docker container vulnerabilities exploiting CVE-2019-5736 

This file is intended to explain how to run the demo for the 
DOCKER VULNERABILITIES made by Crudo Giovambattista.

The import of the .ova file has been tested on virtual box 7.0.4 for windows.

The OS is ubuntu 16.04 

username: alice 
password: alice  

DO NOT UPDATE THE VIRTUAL MACHINE OS, otherwise the demo WILL NOT WORK!!!

-----------------------------------------------------------------------------------------------------------

EXPLOITING PHASE

After the start of the virtual machine the demo can begin.

Is important to check the current version of docker 

    $ docker version 

Should be 18.09.

At this point launch the script "restore-runc.pl"

    $ ./restore-runc.pl 

Then launch the command

    $ runc -v 

The output should be:
    runc version 1.0.0-rc6
    spec: 1.0.1-dev 

NOW WE CAN HACK DOCKER

Two python scripts are there on the Desktop

    1. exec_poc.py 
    2. reverse_poc.py 

Let's start with the first one(exec_poc.py):

    This python script will create a malicious container that will escape from the 
    docker enviroment and alterate the runc binary file on the virtual machine file system.

    Launch the script   

        $ ./exec_poc.py 

    The output will describe the steps that are being executed by the script
    the first step will take about 40 seconds and takes care of the docker container build
    and the update of the container. 

    The following steps are concerned about showing the current runc version, then the hacked runc 
    and the last steps are intended to restore the runc binary.

    If the string "RUNC HACKED BY Gibbi" is printed the attack is successful.

SECOND SCRIPT(reverse_poc.py) 

    This python script will create a malicious container that will escape from the 
    docker enviroment and alterate the runc binary file on the virtual machine file system, opening 
    a reverse shell that can be listened with netcat on port 2345.

    Launch the script:

        $ ./reverse_poc.py 

    Open immediately a second terminal and type:

        $ nc -nvlp 2345  

    The steps will be executed(as before the first step will last about 40 seconds) and at some point 
    a message will display that the reverse shell is opened and on the terminal with netcat listening 
    will be displayed the same.

    With the reverse shell we can execute all the commands of the linux shell and we have access to the 
    machine itself.

    NOTE that if the container is executed with "sudo" permissions (which is a bad practice) 
    we will have superuser access to the shell of the operating system running the container.

-----------------------------------------------------------------------------------------------------------

If something went wrong during the execution of the scripts we need to execute the script that 
restores the runc binary.

    $ ./restore.runc.pl 

-----------------------------------------------------------------------------------------------------------

That's all if something went wrong during the demo please contact me on teams CRUDO GIOVAMBATTISTA 
or via email crdgmb00p23c352i@studenti.unical.it 

-----------------------------------------------------------------------------------------------------------




